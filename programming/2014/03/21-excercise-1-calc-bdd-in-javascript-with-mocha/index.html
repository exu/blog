<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>(Excercise 1 - Javascript) Numbers statistics- Javascript with Mocha &middot; Jacek Wysocki DevLog</title>
    <meta name="author" content="Jacek Wysocki">
    <meta name="description" content="I&#39;m developer recently focused on learning Go, Emacs and Archlinux user, father of two lovely children and amateur runner.">
    <meta name="generator" content="Hugo 0.15-DEV" />
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <link rel="shortcut icon" href="http://wysocki.in/img/favicon.ico">
    <link rel="stylesheet" href="http://wysocki.in/css/normalize.min.css">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="http://wysocki.in/css/screen.css">
    <link rel="stylesheet" href="http://wysocki.in/css/github.css">
    <link rel="stylesheet" href="http://wysocki.in/css/default.min.css">
    <link rel="stylesheet" href="http://wysocki.in/css/site.css">

    <!-- Stylesheet for theme color -->
    <style type="text/css">
    a, a:visited {color: #33cc99;}
    .pagination a {color: #33cc99;}
    .gist .gist-file .gist-meta a:visited {color: #33cc99 !important;}
    a:focus, a:hover {color: #178b6b;}
    h1.post-title a:focus, h1.post-title a:hover, h1.blog-title a:focus, h1.blog-title a:hover {color: #178b6b;}
    .older-posts:hover, .newer-posts:hover {color: #178b6b;}
</style>
</head>

<body class="post-template">

    <header id="site-head">
	
	<h1 class="blog-title">
        <a href="http://wysocki.in/">
            <img src="/img/ja128.png" class="main-image">
            <i class='fa fa-code'></i>
            Jacek Wysocki DevLog
        </a>
    </h1>
	
	
	<h1 class="blog-subtitle">various stuff about programming</h1>
	
</header>

    
<nav class="menu" role="nav">
    <ul>
        
        <li class="nav nav-current"><a href="/">
            <i class='fa fa-heart-o'></i>&nbsp;Posts
        </a></li>
      	
        <li class="nav nav-current"><a href="/tags/">
            <i class='fa fa-star-o'></i>&nbsp;Tags
        </a></li>
      	
        <li class="nav nav-current"><a href="/series/">
            <i class='fa fa-folder-o'></i>&nbsp;Series
        </a></li>
      	
        <li class="nav nav-current"><a href="/til/">
            <i class='fa fa-thumbs-o-up'></i>&nbsp;TIL
        </a></li>
      	
        <li class="nav nav-current"><a href="/contact/">
            <i class='fa fa-envelope-o'></i>&nbsp;Contact
        </a></li>
      	
    </ul>
</nav>



    <div class="pull-right social-media">
        <div>
            <a href="https://twitter.com/share" class="twitter-share-button" data-via="ex00">Tweet</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </div>
        <div>
            <div class="g-plusone" data-size="small"></div>
            <script type="text/javascript">
             (function() {
                 var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
                 po.src = 'https://apis.google.com/js/platform.js';
                 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
             })();
            </script>
        </div>
    </div>

    <main class="content" role="main">
	    <article class="post">
	        <header>
	        <h1 class="post-title">(Excercise 1 - Javascript) Numbers statistics- Javascript with Mocha</h1>
            </header>
	        <section class="post-content">
	            <img src="/img/js-bdd.png" class="img-responsive" alt="">

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Part 1 - Using Javascript with Mocha</h2>
<div class="outline-text-2" id="text-1">
<p>
Your task is to process a sequence of integer numbers
to determine the following statistics:
</p>

<ul class="org-ul">
<li>minimum value
</li>
<li>maximum value
</li>
<li>number of elements in the sequence
</li>
<li>average value
</li>
</ul>

<p>
For example: <code>[6, 9, 15, -2, 92, 11]</code>
</p>

<ul class="org-ul">
<li>minimum value = -2
</li>
<li>maximum value = 92
</li>
<li>number of elements in the sequence = 6
</li>
<li>average value = 21.833333
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="todo TODO">TODO</span> Start in Mocha</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Setup your tools</h3>
<div class="outline-text-3" id="text-2-1">
<p>
In first excercise we'll do everything from scratch. First prepare your tools:
</p>
</div>

<div id="outline-container-sec-2-1-1" class="outline-4">
<h4 id="sec-2-1-1">Project structure</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
First create project directory and cwd to it
</p>

<div class="org-src-container">

<pre class="src src-sh">mkdir jsbdds
<span style="color: #93e0e3;">cd</span> jsbdds

npm install mocha --save-dev
npm install should --save-dev
</pre>
</div>

<p>
I'm using Should.js as assert library so last
line above will install it.
</p>


<p>
NPM will add Mocha to <code>devDependencies</code> and install all related packages into node<sub>modules</sub> directory
</p>

<p>
In examples to simplify project structure we'll make tests in tests directory
and code in root directory.
</p>
<div class="org-src-container">

<pre class="src src-txt">. - your sources
test/  - your specs
package.json - your npm package management
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Spec your code</h3>
<div class="outline-text-3" id="text-2-2">
<p>
put <code>calc.js</code> into your project <code>tests/</code> directory
</p>

<p>
and write some tests
</p>

<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #e2b1f4;">stat</span> = require(<span style="color: #a5a5a5;">'calc'</span>);
<span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #e2b1f4;">should</span> = require(<span style="color: #a5a5a5;">'should'</span>);

describe(<span style="color: #a5a5a5;">'Stat'</span>, <span style="color: #f0dfaf; font-weight: bold;">function</span> () {
    <span style="color: #a5a5a5;">'use strict'</span>;

    describe(<span style="color: #a5a5a5;">'#collect()'</span>, <span style="color: #f0dfaf; font-weight: bold;">function</span> () {
        <span style="color: #5f7f5f;">// </span><span style="color: #5f7f5f;">here will be our spec</span>
    });
})
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Write your Spec</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Example input data</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Our example input data which We will be using in our spec methods:
</p>

<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #e2b1f4;">data</span> = [3, 3, 4, 5, 6, 99, -99, 7, 8, 64];
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Our object project:</h3>
<div class="outline-text-3" id="text-3-2">
<p>
We create <code>collect</code> method which will return
object with <code>min</code>, <code>max</code>, <code>avg</code>,
<code>sum</code>, <code>count</code> keys.
</p>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">When We have plan, we can start writing specs</h3>
<div class="outline-text-3" id="text-3-3">
</div><div id="outline-container-sec-3-3-1" class="outline-4">
<h4 id="sec-3-3-1">Prerequisities (creating matcher)</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
Our first task is to calculate minimum value from
given input.
</p>
</div>
</div>

<div id="outline-container-sec-3-3-2" class="outline-4">
<h4 id="sec-3-3-2">Min specification</h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
Now We're ready for specifing.
</p>

<div class="org-src-container">

<pre class="src src-javascript">it(<span style="color: #a5a5a5;">'calculates min from given integers'</span>, <span style="color: #f0dfaf; font-weight: bold;">function</span> () {
    stat.collect(data).min.should.equal(-99);
});
</pre>
</div>

<div class="org-src-container">

<pre class="src src-sh">mocha
</pre>
</div>

<p>
Mocha should fail with message:
</p>
<div class="org-src-container">

<pre class="src src-sh">Stat <span style="color: #5f7f5f;">#</span><span style="color: #5f7f5f;">collect() calculates min from given integers:</span>
    TypeError: Cannot read property <span style="color: #a5a5a5;">'should'</span> of undefined
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-3-3" class="outline-4">
<h4 id="sec-3-3-3">Other specifications</h4>
<div class="outline-text-4" id="text-3-3-3">
<ol class="org-ol">
<li>With above technique We'll generate:
</li>
</ol>

<div class="org-src-container">

<pre class="src src-php"><span style="color: #cfcfcf; ">it</span>(<span style="color: #a5a5a5;">'calculates max from given integers'</span>, <span style="color: #f0dfaf; font-weight: bold;">function</span> () {
    <span style="color: #d0bf8f; font-weight: bold;">stat</span>.<span style="color: #cfcfcf; ">collect</span>(<span style="color: #d0bf8f; font-weight: bold;">data</span>).<span style="color: #d0bf8f; font-weight: bold;">max</span>.<span style="color: #d0bf8f; font-weight: bold;">should</span>.<span style="color: #cfcfcf; background-color: #1f1f1f;">equal</span>(<span style="color: #ff5555;">99</span>);
});

<span style="color: #cfcfcf; ">it</span>(<span style="color: #a5a5a5;">'calculates avg from given integers'</span>, <span style="color: #f0dfaf; font-weight: bold;">function</span> () {
    <span style="color: #d0bf8f; font-weight: bold;">stat</span>.<span style="color: #cfcfcf; ">collect</span>(<span style="color: #d0bf8f; font-weight: bold;">data</span>).<span style="color: #d0bf8f; font-weight: bold;">avg</span>.<span style="color: #d0bf8f; font-weight: bold;">should</span>.<span style="color: #cfcfcf; background-color: #1f1f1f;">equal</span>(<span style="color: #ff5555;">10</span>);
});

<span style="color: #cfcfcf; ">it</span>(<span style="color: #a5a5a5;">'calculates count from given integers'</span>, <span style="color: #f0dfaf; font-weight: bold;">function</span> () {
    <span style="color: #d0bf8f; font-weight: bold;">stat</span>.<span style="color: #cfcfcf; ">collect</span>(<span style="color: #d0bf8f; font-weight: bold;">data</span>).<span style="color: #d0bf8f; font-weight: bold;">count</span>.<span style="color: #d0bf8f; font-weight: bold;">should</span>.<span style="color: #cfcfcf; background-color: #1f1f1f;">equal</span>(<span style="color: #ff5555;">10</span>);
});

<span style="color: #cfcfcf; ">it</span>(<span style="color: #a5a5a5;">'calculates sum from given integers'</span>, <span style="color: #f0dfaf; font-weight: bold;">function</span> () {
    <span style="color: #d0bf8f; font-weight: bold;">stat</span>.<span style="color: #cfcfcf; ">collect</span>(<span style="color: #d0bf8f; font-weight: bold;">data</span>).<span style="color: #d0bf8f; font-weight: bold;">sum</span>.<span style="color: #d0bf8f; font-weight: bold;">should</span>.<span style="color: #cfcfcf; background-color: #1f1f1f;">equal</span>(<span style="color: #ff5555;">100</span>);
});
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4">Writing code</h3>
<div class="outline-text-3" id="text-3-4">
<p>
Now our spec is ready - it'll be our library documentation - we can
start writing code.
</p>

<p>
<b>Remember</b> to run <code>mocha</code> after each change.
</p>
</div>


<div id="outline-container-sec-3-4-1" class="outline-4">
<h4 id="sec-3-4-1">Now it's time to implement minimum calculation from given input</h4>
<div class="outline-text-4" id="text-3-4-1">
<div class="org-src-container">

<pre class="src src-php"><span style="color: #d0bf8f; font-weight: bold;">module</span>.<span style="color: #d0bf8f; font-weight: bold;">exports</span> = {
    <span style="color: #d0bf8f; font-weight: bold;">collect</span> : <span style="color: #f0dfaf; font-weight: bold;">function</span> (<span style="color: #d0bf8f; font-weight: bold;">arr</span>) {
        <span style="color: #a5a5a5;">'use strict'</span>;

        <span style="color: #f0dfaf; font-weight: bold;">return</span> {
            <span style="color: #a5a5a5;">'min'</span> : <span style="color: #d0bf8f; font-weight: bold;">Math</span>.<span style="color: #d0bf8f; font-weight: bold;">min</span>.<span style="color: #cfcfcf; ">apply</span>(<span style="color: #b0deff;">null</span>, <span style="color: #d0bf8f; font-weight: bold;">arr</span>),
        };
    }
};
</pre>
</div>


<p>
Run mocha
</p>

<div class="org-src-container">

<pre class="src src-sh">$ mocha

  &#8228;&#8228;&#8228;&#8228;&#8228;

  1 passing (26ms)
  4 failing

... undefined messages ...
</pre>
</div>

<p>
Wow horray! First test passed. Now it's time to implement rest
You can do it in little steps one by one, after each
run <code>mocha</code> to check if you don't brake something
in other tests.
</p>
</div>
</div>


<div id="outline-container-sec-3-4-2" class="outline-4">
<h4 id="sec-3-4-2">Whole library looks like this one below:</h4>
<div class="outline-text-4" id="text-3-4-2">
<div class="org-src-container">

<pre class="src src-javascript">module.exports = {
    <span style="color: #a2d7fb;">collect</span> : <span style="color: #f0dfaf; font-weight: bold;">function</span> (<span style="color: #e2b1f4;">arr</span>) {
        <span style="color: #a5a5a5;">'use strict'</span>;

        <span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #e2b1f4;">sum</span> = arr.reduce(<span style="color: #f0dfaf; font-weight: bold;">function</span> (<span style="color: #e2b1f4;">pv</span>, <span style="color: #e2b1f4;">cv</span>) { <span style="color: #f0dfaf; font-weight: bold;">return</span> pv + cv; }, 0);
        <span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #e2b1f4;">length</span> = arr.length;

        <span style="color: #f0dfaf; font-weight: bold;">return</span> {
            <span style="color: #a5a5a5;">'min'</span> : Math.min.apply(<span style="color: #b0deff;">null</span>, arr),
            <span style="color: #a5a5a5;">'max'</span>: Math.max.apply(<span style="color: #b0deff;">null</span>, arr),
            <span style="color: #a5a5a5;">'avg'</span>: sum / length,
            <span style="color: #a5a5a5;">'count'</span>: length,
            <span style="color: #a5a5a5;">'sum'</span>: sum
        };
    }
};
</pre>
</div>

<p>
Run
</p>

<div class="org-src-container">

<pre class="src src-sh">&#10095; mocha test/calc.js

  &#8228;&#8228;&#8228;&#8228;&#8228;

  5 passing (29ms)
</pre>
</div>

<p>
Now all tests should go green :D
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5">Conslusions</h3>
<div class="outline-text-3" id="text-3-5">
<p>
You can compare Javascript with Mocha technique
with other in the same excercise
</p>

<ul class="org-ul">
<li><a href="/bdd-excercise-1-calc-bdd-in-php-with-phpspec">PHP and PHPSpec</a>
</li>
<li><a href="/bdd-excercise-1-calc-bdd-in-golang-and-ginkgo">Golang and Ginkgo</a>
</li>
</ul>
</div>
</div>
</div>

	        </section>

            <section>
                <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'wysocki';
    var disqus_identifier = 'http:\/\/wysocki.in\/programming\/2014\/03\/21-excercise-1-calc-bdd-in-javascript-with-mocha\/';
    var disqus_title = '(Excercise 1 - Javascript) Numbers statistics- Javascript with Mocha';
    var disqus_url = 'http:\/\/wysocki.in\/programming\/2014\/03\/21-excercise-1-calc-bdd-in-javascript-with-mocha\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            </section>
	    </article>
	</main>



    <footer class="site-footer">
	<div class="inner">
		<section class="footer-social">
			
		    <a href="//twitter.com/ex00" target="_blank" title="Twitter"><i class="fa fa-2x fa-fw fa-twitter"></i> <span class="hidden">Twitter</span></a>&nbsp;
		    
		    
		    <a href="//github.com/exu" target="_blank" title="GitHub"><i class="fa fa-2x fa-fw fa-github"></i> <span class="hidden">GitHub</span></a>&nbsp;
		    
		    <a href="" target="_blank" title="RSS"><i class="fa fa-2x fa-fw fa-rss"></i> <span class="hidden">RSS</span></a>
		</section>

		<section class="copyright">&copy; 2016 <a href="http://wysocki.in/">Jacek Wysocki</a>. Released under the MIT license.</section>
	</div>
</footer>
    <script src="http://wysocki.in/js/jquery.min.js"></script>
<script src="http://wysocki.in/js/index.js"></script>
<script src="http://wysocki.in/js/smooth-scroll.min.js"></script>
<script src="http://wysocki.in/js/highlight.min.js"></script>

<script>
    smoothScroll.init({
        speed: 800,
        easing: 'easeInOutCubic',
        updateURL: false,
        offset: 125,
    });
</script>
<script>hljs.initHighlightingOnLoad();</script>


<!-- Google Analytics -->
<script>
  var _gaq=[['_setAccount','UA-1883783-4'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>



</body>
</html>
